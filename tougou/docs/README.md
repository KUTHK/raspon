# Raspberry Pi ホッケーゲーム

このプロジェクトは、Raspberry Piをベアメタルで動作させ、8x8マトリックスLEDとスピーカーを使用して作成したホッケーゲームです。

## プロジェクトの主な成果

### 1. ベアメタルでの音声出力
- Raspberry PiのPWM制御によるスピーカー制御
- BGMと効果音の実装
- 単音での音楽再生の実現

### 2. LEDマトリックス制御
- 8x8マトリックスLEDの制御
- 文字表示、数字表示機能の実装
- アニメーション表示の実現

### 3. ゲーム機能
- 2人対戦可能なホッケーゲーム
- スコア管理システム
- ゲーム状態管理（開始、プレイ中、結果表示）

### 4. チーム開発の特徴
- モジュール化された設計
- 明確なレジスタ利用ルールの策定
- 効率的な統合プロセス

## ディレクトリ構造

```
tougou/
├── core/        # システムコア機能
├── display/     # 表示関連機能
├── game/        # ゲームロジック
├── input/       # 入力処理
├── sound/       # サウンド関連
│   ├── bgm/    # BGMファイル
│   └── se/     # 効果音ファイル
├── ui/          # ユーザーインターフェース
├── include/     # ヘッダーファイル
├── build/       # ビルド関連ファイル
└── docs/        # ドキュメント
```

## 各ディレクトリの説明

### core/
システムの基本機能を提供する中核モジュール：
- `GPIO_init.s` - GPIOの初期化（LED、スピーカー、入力制御）
- `PWM_init.s` - PWM機能の初期化（音声出力用）
- `main_test.s` - メインプログラムの制御

### display/
LEDマトリックスの表示制御を担当：
- `display.s` - LEDマトリックスの基本制御
- `text.s` - 文字表示の制御
- `write_number.s` - 数字表示の制御
- `player_board_draw.s` - プレイヤーボードの描画

### game/
ゲームのコアロジックを実装：
- `ball.s` - ボールの物理演算と移動制御
- `player_board.s` - プレイヤーの操作制御
- `GoalJudg.s` - ゴール判定とスコア処理
- `score.s` - スコア管理システム
- `point.s` - ポイント計算処理

### input/
プレイヤーの入力処理：
- `switch.s` - ボタン入力の検出と処理
- `rotate.s` - 回転入力の処理

### sound/
音声出力の制御：
#### bgm/
- 各種BGMデータ（`MS_bgm_flashman.s`, `MS_bgm_fox_20th.s`等）
- BGMリスト管理（`MS_bgm_list.s`）

#### se/
- 効果音データと制御（`MS_SE.s`, `MS_play_SE.s`）
- サウンド再生システム（`MS_play_bgm.s`）

### ui/
ユーザーインターフェース要素：
- `start.s` - ゲーム開始画面
- `result.s` - 結果表示画面
- `LED.s` - 状態表示用LED制御

### include/
共通のヘッダーファイル：
- `common.h` - 共通定義（GPIO、タイマー等の設定値）
- `sound_source.h` - サウンド関連の定義

## 開発体制

### レジスタ利用ルール
- r0-r3: 一時的な値の保存用
- r4-r8: ゲームの状態管理用
- r9-r12: サブルーチン内での作業用
- r13(sp): スタックポインタ
- r14(lr): リンクレジスタ
- r15(pc): プログラムカウンタ

### モジュール間の連携
- 共通ヘッダー（`common.h`）による定数管理
- 明確な関数インターフェース
- データ構造の統一的な定義

### 統合プロセス
1. 個別機能の開発と単体テスト
2. インターフェースの統一確認
3. 段階的な統合テスト
4. 全体動作の検証

## ビルド方法

1. `build`ディレクトリに移動
```bash
cd build
```

2. makeコマンドを実行
```bash
make
```

3. クリーンビルドを行う場合
```bash
make clean
make
```
